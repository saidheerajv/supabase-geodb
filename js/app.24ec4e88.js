(function(e){function t(t){for(var r,a,i=t[0],s=t[1],u=t[2],b=0,d=[];b<i.length;b++)a=i[b],Object.prototype.hasOwnProperty.call(c,a)&&c[a]&&d.push(c[a][0]),c[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==c[s]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},c={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/supabase-geodb/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0810":function(e,t,n){"use strict";n("6bac")},"13b5":function(e,t,n){"use strict";n("d4ea")},"18fc":function(e,t,n){},"1e07":function(e,t,n){"use strict";n("6b50")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),c={class:"container mt-3 bg-white rounded h-75 overflow-hidden pt-4"},o={key:0},a={class:"text-center border-bottom mt-2"};function i(e,t,n,i,s,u){var l=Object(r["y"])("TitleBar"),b=Object(r["y"])("UserDashboard"),d=Object(r["y"])("Home"),g=Object(r["y"])("Auth");return Object(r["r"])(),Object(r["f"])(r["a"],null,[Object(r["i"])(l),Object(r["g"])("div",c,[s.showLogin?(Object(r["r"])(),Object(r["d"])(g,{key:1})):(Object(r["r"])(),Object(r["f"])("div",o,[i.store.user?(Object(r["r"])(),Object(r["d"])(b,{key:0})):(Object(r["r"])(),Object(r["d"])(d,{key:1}))]))]),Object(r["g"])("p",a,[i.store.user||s.showLogin?Object(r["e"])("",!0):(Object(r["r"])(),Object(r["f"])("button",{key:0,class:"btn btn-secondary m-2 float-right",onClick:t[0]||(t[0]=function(){return u.showLoginFunc&&u.showLoginFunc.apply(u,arguments)})}," Login to Add/Manage listing ")),i.store.user?(Object(r["r"])(),Object(r["f"])("button",{key:1,class:"btn btn-danger m-2 float-right",onClick:t[1]||(t[1]=function(){return u.signOut&&u.signOut.apply(u,arguments)})}," Sign out ")):Object(r["e"])("",!0),s.showLogin?(Object(r["r"])(),Object(r["f"])("button",{key:2,class:"btn btn-secondary m-2 float-right",onClick:t[2]||(t[2]=function(e){return s.showLogin=!s.showLogin})}," Home ")):Object(r["e"])("",!0)])],64)}var s=n("1da1"),u=(n("96cf"),function(e){return Object(r["u"])("data-v-9c817f1a"),e=e(),Object(r["s"])(),e}),l={class:"title"},b=u((function(){return Object(r["g"])("h1",null,"Supabase GeoDB",-1)})),d=[b];function g(e,t,n,c,o,a){return Object(r["r"])(),Object(r["f"])("div",l,d)}var f={name:"TitleBar",props:{msg:String}},O=(n("759a"),n("6b0d")),j=n.n(O);const p=j()(f,[["render",g],["__scopeId","data-v-9c817f1a"]]);var h=p,m=Object(r["v"])({user:{}}),v=n("940b"),y={},w=Object(v["a"])("https://rhsugtnhvfojipiyrizv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyOTg3MjU0NCwiZXhwIjoxOTQ1NDQ4NTQ0fQ.dCZFzVF9B4CUIkXNPsdXHKDGr9YoT1EOXlxG7yyQaJg",y),L={class:"row justify-content-md-center"},x={class:"col-sm-6 px-3 border-end"},k={class:"col-sm-6 px-5"};function _(e,t,n,c,o,a){var i=Object(r["y"])("GetUserListings"),s=Object(r["y"])("PostLocation");return Object(r["r"])(),Object(r["f"])("div",L,[Object(r["g"])("div",x,[Object(r["i"])(i)]),Object(r["g"])("div",k,[Object(r["i"])(s)])])}n("b0c0"),n("a4d3"),n("e01a");var C=function(e){return Object(r["u"])("data-v-625f7508"),e=e(),Object(r["s"])(),e},A={key:0,class:"alert alert-success"},I={key:1,class:"alert alert-warning"},P={class:""},S=C((function(){return Object(r["g"])("h3",{class:"text-dark mb-3"},"Post Listing",-1)})),U={class:"text-end"};function D(e,t,n,c,o,a){return Object(r["r"])(),Object(r["f"])(r["a"],null,[o.successAlert?(Object(r["r"])(),Object(r["f"])("p",A," Added Listing successfully ! ")):Object(r["e"])("",!0),o.errorAlert?(Object(r["r"])(),Object(r["f"])("p",I," Error Adding Listing ! Please try again. ")):Object(r["e"])("",!0),Object(r["g"])("div",P,[S,Object(r["E"])(Object(r["g"])("input",{class:"form-control my-2","onUpdate:modelValue":t[0]||(t[0]=function(e){return o.name=e}),placeholder:"Enter name"},null,512),[[r["C"],o.name]]),Object(r["E"])(Object(r["g"])("input",{class:"form-control my-2","onUpdate:modelValue":t[1]||(t[1]=function(e){return o.loc_string=e}),placeholder:"Paste google maps url"},null,512),[[r["C"],o.loc_string]]),Object(r["E"])(Object(r["g"])("textarea",{class:"form-control my-2","onUpdate:modelValue":t[2]||(t[2]=function(e){return o.description=e}),placeholder:"Description"},"\n    ",512),[[r["C"],o.description]]),Object(r["g"])("div",U,[Object(r["g"])("button",{class:"btn action-btn m-2 float-right",onClick:t[3]||(t[3]=function(){return a.postListing&&a.postListing.apply(a,arguments)})}," Add Listing ")])])],64)}n("ac1f"),n("466d"),n("4de4"),n("caad"),n("2532");var R={name:"PostLocation",data:function(){return{name:"",loc_string:"",description:"",successAlert:!1,errorAlert:!1}},methods:{postListing:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,r,c,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.getLatLong(e.loc_string),r=new Date,c={name:e.name,location:"SRID=4326;POINT("+n.lat+" "+n.long+")",description:e.description,tags:"xyz abc",coords:JSON.stringify(n),created_at:r,updated_at:r,added_by:m.user.id},e.successAlert=!1,t.next=6,w.from("all_locations").insert([c]).single();case 6:o=t.sent,a=o.error,a?e.errorAlert=!0:e.successAlert=!0;case 9:case"end":return t.stop()}}),t)})))()},getLatLong:function(e){var t=/[+-]?\d+(\.\d+)?/g,n=e.match(t);return n=n.filter((function(e){return e.length>4&&e.includes(".")})),{lat:n[0],long:n[1]}}}};n("931b");const B=j()(R,[["render",D],["__scopeId","data-v-625f7508"]]);var G=B,T={class:"my-1"},E=Object(r["g"])("h3",{class:"text-dark mb-3"},"Your Listings",-1),M={key:0},N={key:1},J=Object(r["g"])("div",{class:"alert alert-warning text-center",role:"alert"},[Object(r["g"])("h5",null,"You don't have any listings yet!")],-1),F=[J];function V(e,t,n,c,o,a){var i=Object(r["y"])("ListingCard");return Object(r["r"])(),Object(r["f"])("div",T,[E,o.items.length>0?(Object(r["r"])(),Object(r["f"])("div",M,[(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["x"])(o.items,(function(e){return Object(r["r"])(),Object(r["f"])("div",{key:e.id},[Object(r["i"])(i,{loc:e,showDeleteBtn:!0,showActionBtn:!1},null,8,["loc"])])})),128))])):(Object(r["r"])(),Object(r["f"])("div",N,F))])}var Y={class:"card w-100 my-2"},H={class:"card-body"},Q={class:"card-title"},X={class:"card-text"},z={class:"text-end"},K=["href"];function Z(e,t,n,c,o,a){return Object(r["r"])(),Object(r["f"])("div",Y,[Object(r["g"])("div",H,[Object(r["g"])("h5",Q,Object(r["A"])(n.loc.name),1),Object(r["g"])("p",X,Object(r["A"])(n.loc.description),1),Object(r["g"])("p",z,[n.showActionBtn?(Object(r["r"])(),Object(r["f"])("a",{key:0,href:"https://www.google.com/maps/place/"+n.loc.coords.lat+","+n.loc.coords.long,target:"_blank",class:"btn directions-btn text-white mx-2"}," Get Directions ",8,K)):Object(r["e"])("",!0),n.showDeleteBtn?(Object(r["r"])(),Object(r["f"])("button",{key:1,class:"btn btn-danger mx-2",onClick:t[0]||(t[0]=function(e){return a.deleteListing(n.loc.id)})}," Delete Listing ")):Object(r["e"])("",!0)])])])}var q={name:"ListingCard",props:{loc:Object,showDeleteBtn:Boolean,showActionBtn:Boolean},methods:{deleteListing:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log(e),n.next=3,w.from("all_locations").delete().match({id:e});case 3:r=n.sent,c=r.error,c||t.$parent.getUserListings(m.user.id);case 6:case"end":return n.stop()}}),n)})))()}}};n("1e07");const W=j()(q,[["render",Z],["__scopeId","data-v-98172322"]]);var $=W,ee={name:"GetUserListings",components:{ListingCard:$},created:function(){this.getUserListings(m.user.id)},data:function(){return{navigatorError:!1,coords:{},items:[],radii:20}},methods:{getUserListings:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,c,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,w.from("all_locations").select().eq("added_by",e);case 2:if(r=n.sent,c=r.data,o=r.error,!o){n.next=8;break}return console.log("error",o),n.abrupt("return");case 8:if(console.log(c),null!==c){n.next=12;break}return c.value=[],n.abrupt("return");case 12:t.items=c;case 13:case"end":return n.stop()}}),n)})))()}}};const te=j()(ee,[["render",V]]);var ne=te,re={name:"UserDashboard",components:{PostLocation:G,GetUserListings:ne}};n("0810");const ce=j()(re,[["render",_]]);var oe=ce,ae={class:"row justify-content-center bg-white"},ie={class:"col-12 px-5"};function se(e,t,n,c,o,a){var i=Object(r["y"])("GetLocations");return Object(r["r"])(),Object(r["f"])("div",ae,[Object(r["g"])("div",ie,[Object(r["i"])(i)])])}var ue={class:"my-1"},le={class:"float-end"},be={key:0},de=Object(r["g"])("h4",{class:"text-secondary mb-3"},"Found following things around you",-1),ge={key:1},fe=Object(r["g"])("div",{class:"alert alert-warning text-center",role:"alert"},[Object(r["g"])("h5",null,"Sorry ! No listings found aroud you.")],-1),Oe=[fe];function je(e,t,n,c,o,a){var i=Object(r["y"])("ListingCard");return Object(r["r"])(),Object(r["f"])("div",ue,[Object(r["g"])("p",null,"You're at : "+Object(r["A"])(o.coords.latitude)+", "+Object(r["A"])(o.coords.longitude),1),Object(r["g"])("label",le," looking in "+Object(r["A"])(o.radii)+" KMs radius ",1),Object(r["E"])(Object(r["g"])("input",{type:"range",class:"form-range",min:"2",max:"102",step:"10",id:"kmsRange","onUpdate:modelValue":t[0]||(t[0]=function(e){return o.radii=e}),onChange:t[1]||(t[1]=function(){return a.radiusChange&&a.radiusChange.apply(a,arguments)})},null,544),[[r["C"],o.radii]]),o.items.length>0?(Object(r["r"])(),Object(r["f"])("div",be,[de,(Object(r["r"])(!0),Object(r["f"])(r["a"],null,Object(r["x"])(o.items,(function(e){return Object(r["r"])(),Object(r["f"])("div",{key:e.id},[Object(r["i"])(i,{loc:e,showDeleteBtn:!1,showActionBtn:!0},null,8,["loc"])])})),128))])):(Object(r["r"])(),Object(r["f"])("div",ge,Oe))])}n("159b");var pe={name:"GetUserListings",components:{ListingCard:$},data:function(){return{navigatorError:!1,coords:{},items:[],radii:20}},created:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.showPosition):console.log("Geolocation is not supported by this browser.")},methods:{radiusChange:function(){console.log(this.radii),this.getLocations(this.coords,this.radii)},showPosition:function(e){this.coords=e.coords,this.getLocations(this.coords,100)},getLocations:function(e){var t=arguments,n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var c,o,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return c=t.length>1&&void 0!==t[1]?t[1]:100,r.next=3,w.rpc("get_listings",{radius:c,point:"SRID=4326;POINT("+e.latitude+" "+e.longitude+")"});case 3:if(o=r.sent,a=o.data,i=o.error,!i){r.next=9;break}return console.log("error",i),r.abrupt("return");case 9:if(null!==a){r.next=12;break}return a.value=[],r.abrupt("return");case 12:n.items=a,n.items.forEach((function(e){e.coords=JSON.parse(e.coords)}));case 14:case"end":return r.stop()}}),r)})))()}}};const he=j()(pe,[["render",je]]);var me=he,ve={name:"Home",components:{GetLocations:me}};const ye=j()(ve,[["render",se]]);var we=ye,Le=function(e){return Object(r["u"])("data-v-075c994c"),e=e(),Object(r["s"])(),e},xe={class:"mt-4"},ke=Le((function(){return Object(r["g"])("h3",{class:"header text-dark"},"Sign in to Add/Manage your listing",-1)})),_e=Le((function(){return Object(r["g"])("p",{class:"description text-secondary"},"Sign in via magic link with your email below",-1)})),Ce={key:0,class:"alert alert-success"},Ae=Object(r["h"])(" Magic link sent to your email successfully! "),Ie=Le((function(){return Object(r["g"])("br",null,null,-1)})),Pe=Object(r["h"])(" Please check your email to login "),Se=[Ae,Ie,Pe],Ue=["value","disabled"];function De(e,t,n,c,o,a){return Object(r["r"])(),Object(r["f"])("form",{class:"d-flex justify-content-center mt-5 mx-3",onSubmit:t[1]||(t[1]=Object(r["F"])((function(){return c.handleLogin&&c.handleLogin.apply(c,arguments)}),["prevent"]))},[Object(r["g"])("div",xe,[ke,_e,c.emailSent?(Object(r["r"])(),Object(r["f"])("p",Ce,Se)):Object(r["e"])("",!0),Object(r["g"])("div",null,[Object(r["E"])(Object(r["g"])("input",{class:"form-control my-2",type:"email",placeholder:"Your email","onUpdate:modelValue":t[0]||(t[0]=function(e){return c.email=e})},null,512),[[r["C"],c.email]])]),Object(r["g"])("div",null,[Object(r["g"])("input",{type:"submit",class:"btn action-btn float-end my-2",value:c.loading?"Loading":"Send Magic link",disabled:c.loading},null,8,Ue)])])],32)}var Re={data:function(){return{}},setup:function(){var e=Object(r["w"])(!1),t=Object(r["w"])(""),n=Object(r["w"])(!1),c=function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(){var c,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.value=!0,n.value=!1,r.next=5,w.auth.signIn({email:t.value});case 5:if(c=r.sent,o=c.error,!o){r.next=9;break}throw o;case 9:n.value=!0,r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](0),alert(r.t0.error_description||r.t0.message);case 15:return r.prev=15,e.value=!1,r.finish(15);case 18:case"end":return r.stop()}}),r,null,[[0,12,15,18]])})));return function(){return r.apply(this,arguments)}}();return{loading:e,email:t,handleLogin:c,emailSent:n}}};n("13b5");const Be=j()(Re,[["render",De],["__scopeId","data-v-075c994c"]]);var Ge=Be,Te={name:"App",data:function(){return{showLogin:!1}},components:{TitleBar:h,Home:we,UserDashboard:oe,Auth:Ge},setup:function(){return m.user=null,w.auth.onAuthStateChange((function(e,t){t&&t.user?m.user=t.user:m.user=null})),{store:m}},methods:{showLoginFunc:function(){this.showLogin=!0},signOut:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w.auth.signOut();case 2:t=e.sent,n=t.error,n||console.log("Logged out successfully!");case 5:case"end":return e.stop()}}),e)})))()}}};n("bd7e");const Ee=j()(Te,[["render",i]]);var Me=Ee,Ne=(n("ab8b"),n("7b17"),n("6c02")),Je=[{path:"/",name:"Home",component:we},{path:"/login",name:"Login",component:Ge},{path:"/dashboard",name:"UserDashboard",component:oe}],Fe=Object(Ne["a"])({history:Object(Ne["b"])(),routes:Je}),Ve=Fe;Object(r["c"])(Me).use(Ve).mount("#app")},"6b50":function(e,t,n){},"6bac":function(e,t,n){},"759a":function(e,t,n){"use strict";n("18fc")},"931b":function(e,t,n){"use strict";n("a075")},a075:function(e,t,n){},a8fe:function(e,t,n){},bd7e:function(e,t,n){"use strict";n("a8fe")},d4ea:function(e,t,n){}});
//# sourceMappingURL=app.24ec4e88.js.map